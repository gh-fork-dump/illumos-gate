.\"
.\" The contents of this file are subject to the terms of the
.\" Common Development and Distribution License (the "License").
.\" You may not use this file except in compliance with the License.
.\"
.\" You can obtain a copy of the license at usr/src/OPENSOLARIS.LICENSE
.\" or http://www.opensolaris.org/os/licensing.
.\" See the License for the specific language governing permissions
.\" and limitations under the License.
.\"
.\" When distributing Covered Code, include this CDDL HEADER in each
.\" file and include the License file at usr/src/OPENSOLARIS.LICENSE.
.\" If applicable, add the following below this CDDL HEADER, with the
.\" fields enclosed by brackets "[]" replaced with your own identifying
.\" information: Portions Copyright [yyyy] [name of copyright owner]
.\"
.\"
.\" Copyright (c) 2008, Sun Microsystems, Inc. All Rights Reserved
.\"
.Dd March 6, 2017
.Dt GETAUDIT 2
.Os
.Sh NAME
.Nm getaudit , setaudit , getaudit_addr , setaudit_addr
.Nd get or set process audit information
.Sh LIBRARY
.Lb libbsm
.Lb libsocket
.Lb libnsl
.Sh SYNOPSIS
.In sys/param.h
.In bsm/libbsm.h
.Ft int
.Fn getaudit "struct auditinfo *info"
.Ft int
.Fn setaudit "struct auditinfo *info"
.Ft int
.Fn getaudit_addr "struct auditinfo_addr *info" "int length"
.Ft int
.Fn setaudit_addr "struct auditinfo_addr *info" "int length"
.Sh DESCRIPTION
The
.Fn getaudit
function gets the audit ID, the preselection mask, the terminal ID and the
audit session ID for the current process.
The
.Fn getaudit
function can fail with
.Er E2BIG
if the address field in the terminal ID is larger than 32 bits.
In this case,
.Fn getaudit_addr
should be used.
.Pp
The
.Fn setaudit
function sets the audit ID, the preselection mask, the terminal ID and the
audit session ID for the current process.
.Pp
The
.Fn getaudit_addr
function returns a variable length
.Vt auditinfo_addr
structure that contains the audit ID, the preselection mask, the terminal ID,
and the audit session ID for the current process.
The terminal ID contains a size field that indicates the size of the network
address.
.Pp
The
.Fn setaudit_addr
function sets the audit ID, the preselection
mask, the terminal ID, and the audit session ID for the current
process.
The values are taken from the variable length structure
.Vt auditinfo_addr .
The terminal ID contains a size field that indicates the size of the network
address.
.Pp
The
.Vt auditinfo
structure is used to pass the process audit information and contains the
following members:
.Bd -literal -offset indent
au_id_t     ai_auid;        /* audit user ID */
au_mask_t   ai_mask;        /* preselection mask */
au_tid_t    ai_termid;      /* terminal ID */
au_asid_t   ai_asid;        /* audit session ID */
.Ed
.Pp
The
.Vt auditinfo_addr
structure is used to pass the process audit information and contains the
following members:
.Bd -literal -offset indent
au_id_t        ai_auid;      /* audit user ID */
au_mask_t      ai_mask;      /* preselection mask */
au_tid_addr_t  ai_termid;    /* terminal ID */
au_asid_t      ai_asid;      /* audit session ID */
.Ed
.Sh RETURN VALUES
.Rv -std getaudit setaudit
.Sh ERRORS
The
.Fn getaudit
and
.Fn setaudit
functions will fail if:
.Bl -tag -width Er
.It Bq Er EFAULT
The
.Fa info
parameter points outside the process's allocated address space.
.It Bq Er EPERM
The
.Brq Dv PRIV_SYS_AUDIT
privilege is not asserted in the effective set of the calling process.
.El
.Sh USAGE
The calling process must have the
.Brq Dv PRIV_SYS_AUDIT
privilege asserted in its effective set.
.Sh INTERFACE STABILITY
.Sy Stable
.Sh MT-LEVEL
.Sy MT-Safe
.Sh SEE ALSO
.Xr audit 2 ,
.Xr attributes 5
