.\"
.\" The contents of this file are subject to the terms of the
.\" Common Development and Distribution License (the "License").
.\" You may not use this file except in compliance with the License.
.\"
.\" You can obtain a copy of the license at usr/src/OPENSOLARIS.LICENSE
.\" or http://www.opensolaris.org/os/licensing.
.\" See the License for the specific language governing permissions
.\" and limitations under the License.
.\"
.\" When distributing Covered Code, include this CDDL HEADER in each
.\" file and include the License file at usr/src/OPENSOLARIS.LICENSE.
.\" If applicable, add the following below this CDDL HEADER, with the
.\" fields enclosed by brackets "[]" replaced with your own identifying
.\" information: Portions Copyright [yyyy] [name of copyright owner]
.\"
.\"
.\" Copyright (c) David L. Mills 1992, 1993, 1994, 1995, 1996, 1997
.\" Portions Copyright (c) 1997, Sun Microsystems, Inc. All Rights Reserved
.\"
.Dd May 13, 2017
.Dt NTP_GETTIME 2
.Os
.Sh NAME
.Nm ntp_gettime
.Nd get local clock values
.Sh SYNOPSIS
.In sys/timex.h
.Ft int
.Fn ntp_gettime "struct ntptimeval *tptr"
.Sh DESCRIPTION
The
.Fn ntp_gettime
function reads the local clock value and dispersion,
returning the information in
.Fa tptr .
.Pp
The
.Vt ntptimeval
structure contains the following members:
.Bd -literal
struct ntptimeval {
    struct timeval   time;       /* current time (ro) */
    int32_t          maxerror;   /* maximum error (us) (ro) */
    int32_t          esterror;   /* estimated error (us) (ro) */
};
.Ed
.Sh RETURN VALUES
Upon successful completion,
.Fn ntp_gettime
returns the current clock state
.Pq see In sys/timex.h ;
otherwise it returns -1 and the global variable
.Va errno
is set to indicate the error.
.Sh ERRORS
The
.Fn ntp_gettime
function will fail if:
.Bl -tag -width Er
.It Bq Ev EFAULT
.Fa tptr
points to an invalid address.
.El
.Pp
The
.Fn ntp_gettime
function will fail for 32-bit interfaces with:
.Bl -tag -width Er
.It Bq Er EOVERFLOW
The size of the
.Va time.tv_sec
member of the
.Vt ntptimeval
structure pointed to by
.Fa tptr
is too small to contain the correct number of seconds.
.El
.Sh SEE ALSO
.Xr ntp_adjtime 2
