.\"
.\" The contents of this file are subject to the terms of the
.\" Common Development and Distribution License (the "License").
.\" You may not use this file except in compliance with the License.
.\"
.\" You can obtain a copy of the license at usr/src/OPENSOLARIS.LICENSE
.\" or http://www.opensolaris.org/os/licensing.
.\" See the License for the specific language governing permissions
.\" and limitations under the License.
.\"
.\" When distributing Covered Code, include this CDDL HEADER in each
.\" file and include the License file at usr/src/OPENSOLARIS.LICENSE.
.\" If applicable, add the following below this CDDL HEADER, with the
.\" fields enclosed by brackets "[]" replaced with your own identifying
.\" information: Portions Copyright [yyyy] [name of copyright owner]
.\"
.\"
.\" Copyright (c) 2004, Sun Microsystems, Inc. All Rights Reserved
.\"
.Dd March 22, 2004
.Dt SETREUID 2
.Os
.Sh NAME
.Nm setreuid
.Nd set real and effective user IDs
.Sh SYNOPSIS
.In unistd.h
.Ft int
.Fn setreuid "uid_t ruid" "uid_t euid"
.Sh DESCRIPTION
The
.Fn setreuid
function is used to set the real and effective user IDs of
the calling process.
If
.Fa ruid
is -1, the real user ID is not changed; if
.Fa euid
is -1, the effective user ID is not changed.
The real and effective user IDs may be set to different values in the same
call.
.Pp
If the
.Brq Dv PRIV_PROC_SETID
privilege is asserted in the effective set of the calling process, the real
user ID and the effective user ID can be set to any legal value.
.Pp
If the
.Brq Dv PRIV_PROC_SETID
privilege is not asserted in the effective set of the calling process, either
the real user ID can be set to the effective user ID, or the effective user ID
can either be set to the saved set-user ID from
.Xr execve 2
or the real user ID.
.Pp
In either case, if the real user ID is being changed (that is, if
.Fa ruid
is not -1), or the effective user ID is being changed to a value not equal to
the real user ID, the saved set-user ID is set equal to the new effective user
ID.
.Pp
All privileges are required to change to uid 0.
.Sh RETURN VALUES
Upon successful completion, the value 0 is returned;
otherwise the value -1 is returned, the global variable
.Va errno
is set to indicate the error, and neither of the user IDs will be changed.
.Sh ERRORS
The
.Fn setreuid
function will fail if:
.Bl -tag -width Er
.It Bq Er EINVAL
The value of  ruid  or  euid  is less than   0  or greater than
.Dv UID_MAX Pq defined in In limits.h .
.It Bq Er EPERM
The
.Brq Dv PRIV_PROC_SETID
privilege is not asserted in the effective set of the
calling processes and a change was specified other than changing the real user
ID to the effective user ID, or changing the effective user
ID to the real user ID or the saved set-user ID.
See
.Xr privileges 5
for additional restrictions which apply when changing to UID 0.
.El
.Sh USAGE
If a set-user-ID process sets its effective user ID to its real
user ID, it can still set its effective user ID back to the saved
set-user ID.
.Sh INTERFACE STABILITY
.Sy Standard
.Sh SEE ALSO
.Xr exec 2 ,
.Xr getuid 2 ,
.Xr setregid 2 ,
.Xr setuid 2 ,
.Xr attributes 5 ,
.Xr privileges 5 ,
.Xr standards 5
