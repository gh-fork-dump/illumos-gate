.\"  Copyright 1989 AT&T  Copyright (c) 2001, Sun Microsystems, Inc.  All Rights Reserved
.\" The contents of this file are subject to the terms of the Common Development and Distribution License (the "License").  You may not use this file except in compliance with the License.
.\" You can obtain a copy of the license at usr/src/OPENSOLARIS.LICENSE or http://www.opensolaris.org/os/licensing.  See the License for the specific language governing permissions and limitations under the License.
.\" When distributing Covered Code, include this CDDL HEADER in each file and include the License file at usr/src/OPENSOLARIS.LICENSE.  If applicable, add the following below this CDDL HEADER, with the fields enclosed by brackets "[]" replaced with your own identifying information: Portions Copyright [yyyy] [name of copyright owner]
.Dd July 23, 2001
.Dt USTAT 2
.Os
.Sh NAME
.Nm ustat
.Nd get file system statistics
.Sh SYNOPSIS
.In sys/types.h
.In ustat.h
.Ft int
.Fn ustat "dev_t dev" "struct ustat *buf"
.Sh DESCRIPTION
The
.Fn ustat
function returns information about a mounted file system.
The
.Fa dev
argument is a device number identifying a device containing a
mounted file system
.Pq see Xr makedev 3C .
The
.Fa buf
argument is a
pointer to a
.Vt ustat
structure that includes the following members:
.Bd -literal -offset indent
daddr_t  f_tfree;      /* Total free blocks */
ino_t    f_tinode;     /* Number of free inodes */
char     f_fname[6];   /* Filsys name */
char     f_fpack[6];   /* Filsys pack name */
.Ed
.Pp
The
.Va f_fname
and
.Va f_fpack
members may not contain significant information on all systems; in this case,
these members will contain the null character as the first character.
.Sh RETURN VALUES
.Rv -std
.Sh ERRORS
The
.Fn ustat
function will fail if:
.Bl -tag -width Er
.It Bq Er ECOMM
The
.Fa dev
argument is on a remote machine and the link to that machine is no longer
active.
.It Bq Er EFAULT
The
.Fa buf
argument points to an illegal address.
.It Bq Er EINTR
A signal was caught during the execution of the
.Fn ustat
function.
.It Bq Er EINVAL
The
.Fa dev
argument is not the device number of a device containing a mounted file system.
.It Bq Er ENOLINK
The
.Fa dev
argument refers to a device on a remote machine and the link to that machine is
no longer active.
.It Bq Er EOVERFLOW
One of the values returned cannot be represented in the structure pointed to by
.Fa buf .
.El
.Sh USAGE
The
.Xr statvfs 2
function should be used in favor of
.Fn ustat .
.Sh SEE ALSO
.Xr stat 2 ,
.Xr statvfs 2 ,
.Xr makedev 3C ,
.Xr lfcompile 5
.Sh BUGS
The NFS revision 2 protocol does not permit the number of free files to be
provided to the client; therefore, when
.Fn ustat
has completed on an NFS file system,
.Va f_tinode
is always -1.
