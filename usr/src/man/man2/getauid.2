.\"
.\" The contents of this file are subject to the terms of the
.\" Common Development and Distribution License (the "License").
.\" You may not use this file except in compliance with the License.
.\"
.\" You can obtain a copy of the license at usr/src/OPENSOLARIS.LICENSE
.\" or http://www.opensolaris.org/os/licensing.
.\" See the License for the specific language governing permissions
.\" and limitations under the License.
.\"
.\" When distributing Covered Code, include this CDDL HEADER in each
.\" file and include the License file at usr/src/OPENSOLARIS.LICENSE.
.\" If applicable, add the following below this CDDL HEADER, with the
.\" fields enclosed by brackets "[]" replaced with your own identifying
.\" information: Portions Copyright [yyyy] [name of copyright owner]
.\"
.\"
.\" Copyright (c) 2008, Sun Microsystems, Inc. All Rights Reserved
.\"
.Dd March 6, 2017
.Dt GETAUID 2
.Os
.Sh NAME
.Nm getauid , setauid
.Nd get or set user audit identity
.Sh LIBRARY
.Lb libbsm
.Lb libsocket
.Lb libnsl
.Sh SYNOPSIS
.In sys/param.h
.In bsm/libbsm.h
.Ft int
.Fn getauid "au_id_t *auid"
.Ft int
.Fn setauid "au_id_t *auid"
.Sh DESCRIPTION
The
.Fn getauid
function returns the audit user ID for the current process.
This value is initially set at login time and inherited by all child processes.
This value does not change when the real/effective user IDs change, so it can
be used to identify the logged-in user even when running a setuid program.
The audit user ID governs audit decisions for a process.
.Pp
The
.Fn setauid
function sets the audit user ID for the current process.
.Sh RETURN VALUES
The
.Fn getauid
function returns the audit user ID of the current process if successful;
otherwise the value -1 is returned and the global variable
.Va errno
is set to indicate the error.
.Pp
.Rv -std setauid
.Sh ERRORS
The
.Fn getauid
and
.Fn setauid
functions will fail if:
.Bl -tag -width Er
.It Bq Er EFAULT
The
.Fn auid
argument points to an invalid address.
.It Bq Er EPERM
The
.Brq Dv PRIV_SYS_AUDIT
privilege is not asserted in the effective set of the calling process.
.El
.Pp
The
.Fn getauid
function will fail if:
.Bl -tag -width Er
.It Bq Er EPERM
The
.Brq Dv PRIV_PROC_AUDIT
privilege is not asserted in the effective set of the calling process.
.El
.Sh USAGE
Only a process with appropriate privileges can successfully execute these
calls.
.Sh SEE ALSO
.Xr audit 2 ,
.Xr getaudit 2 ,
.Xr privileges 5
.Sh NOTES
These functions have been superseded by
.Xr getaudit 2
and
.Xr setaudit 2 .
