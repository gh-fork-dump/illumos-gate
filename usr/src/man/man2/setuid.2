.\"
.\" The contents of this file are subject to the terms of the
.\" Common Development and Distribution License (the "License").
.\" You may not use this file except in compliance with the License.
.\"
.\" You can obtain a copy of the license at usr/src/OPENSOLARIS.LICENSE
.\" or http://www.opensolaris.org/os/licensing.
.\" See the License for the specific language governing permissions
.\" and limitations under the License.
.\"
.\" When distributing Covered Code, include this CDDL HEADER in each
.\" file and include the License file at usr/src/OPENSOLARIS.LICENSE.
.\" If applicable, add the following below this CDDL HEADER, with the
.\" fields enclosed by brackets "[]" replaced with your own identifying
.\" information: Portions Copyright [yyyy] [name of copyright owner]
.\"
.\"
.\" Copyright 1989 AT&T
.\" Copyright (c) 2003, Sun Microsystems, Inc. All Rights Reserved
.\"
.Dd January 20, 2003
.Dt SETUID 2
.Os
.Sh NAME
.Nm setuid , setegid , seteuid , setgid
.Nd set user and group IDs
.Sh SYNOPSIS
.In sys/types.h
.In unistd.h
.Ft int
.Fn setuid "uid_t uid"
.Ft int
.Fn setgid "gid_t gid"
.Ft int
.Fn seteuid "uid_t euid"
.Ft int
.Fn setegid "gid_t egid"
.Sh DESCRIPTION
The
.Fn setuid
function sets the real user ID, effective user ID, and saved user ID of the
calling process.
The
.Fn setgid
function sets the real group ID, effective group ID, and saved group ID of the
calling process.
The
.Fn setegid
and
.Fn seteuid
functions set the effective group and user IDs respectively for the calling
process.
See
.Xr Intro 2
for more information on real, effective, and saved user and group IDs.
.Pp
At login time, the real user ID, effective user ID, and saved user ID of the
login process are set to the login ID of the user responsible for the creation
of the process.
The same is true for the real, effective, and saved group IDs; they are set to
the group ID of the user responsible for the creation of the process.
.Pp
When a process calls one of the
.Xr exec 2
family of functions to execute a file (program), the user and/or group
identifiers associated with the process can change.
If the file executed is a set-user-ID file, the effective and saved user IDs of
the process are set to the owner of the file executed.
If the file executed is a set-group-ID file, the effective and saved group IDs
of the process are set to the group of the file executed.
If the file executed is not a set-user-ID or set-group-ID file, the effective
user ID, saved user ID, effective group ID, and saved group ID are not changed.
.Pp
If the
.Brq Dv PRIV_PROC_SETID
privilege is asserted in the effective set of the process calling
.Fn setuid ,
the real, effective, and saved user IDs are set to the
.Fa uid
argument.
If the
.Fa uid
argument is 0 and none of the saved, effective or real UID is 0, additional
restrictions apply.
See
.Xr privileges 5 .
.Pp
If the
.Brq Dv PRIV_PROC_SETID
privilege is not asserted in the effective set, but
.Fa uid
is either the real user ID or the saved user ID of the calling process, the
effective user ID is set to
.Fa uid .
.Pp
If the
.Brq Dv PRIV_PROC_SETID
privilege is asserted in the effective set of
the process calling
.Fn getgid ,
the real, effective, and saved group IDs
are set to the
.Fa gid
argument.
.Pp
If the
.Brq Dv PRIV_PROC_SETID
privilege is not asserted in the effective set,
but
.Fa gid
is either the real group ID or the saved group ID of the calling
process, the effective group ID is set to
.Fa gid .
.Sh RETURN VALUES
.Rv -std
.Sh ERRORS
The
.Fn setuid
and
.Fn setgid
functions will fail if:
.Bl -tag -width Er
.It Bq Er EINVAL
The value of
.Fa uid
or
.Fa gid
is out of range.
.It Bq Er EPERM
For
.Fn setuid
and
.Fn seteuid ,
the
.Brq Dv PRIV_PROC_SETID
privilege is not asserted in the effective set of the calling process and the
.Fa uid
argument does not match either the real or saved user IDs, or an attempt is
made to change to UID 0 and none of the existing UIDs is 0, in which case
additional privileges are required.
.Pp
For
.Fn setgid
and
.Fn setegid ,
the
.Brq Dv PRIV_PROC_SETID
privilege is not asserted in the effective set and the
.Fa gid
argument does not match either the real or saved group IDs.
.El
.Sh INTERFACE STABILITY
.Sy Standard
.Sh MT-LEVEL
.Sy Async-Signal-Safe
.Sh SEE ALSO
.Xr exec 2 ,
.Xr getgroups 2 ,
.Xr getuid 2 ,
.Xr Intro 2 ,
.Xr stat.h 3HEAD ,
.Xr attributes 5 ,
.Xr privileges 5 ,
.Xr standards 5
